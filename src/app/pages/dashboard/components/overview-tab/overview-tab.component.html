<div class="overview-container">
  <div *ngIf="isLoading" class="loading-state">
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
    <div class="skeleton-card"></div>
  </div>

  <div *ngIf="!isLoading && dashboardData" class="overview-content">
    <!-- Top Row: Balance, Income, Expense -->
    <div class="top-row">
      <!-- Main Balance Card -->
      <div class="balance-card">
        <div class="balance-label">Total balance</div>
        <div class="balance-amount">{{formatNumber(dashboardData.totalBalance)}}<sup>$</sup></div>
        <div class="balance-change">+{{formatCurrency(2456)}} revenue from last month</div>
        <div class="balance-actions">
          <button class="btn-transfer">Transfer</button>
          <button class="btn-topup">Top Up</button>
        </div>
      </div>

      <!-- Income Card -->
      <div class="stat-card stat-income">
        <div class="stat-label">Income</div>
        <div class="stat-value">+{{formatNumber(dashboardData.monthlyIncome/4)}}<sup>$</sup></div>
        <div class="stat-footer">
          <span>This week's income</span>
          <span class="badge-up"></span>
        </div>
      </div>

      <!-- Expense Card -->
      <div class="stat-card stat-expense">
        <div class="stat-label">Expense</div>
        <div class="stat-value">-{{formatNumber(dashboardData.monthlyExpense/4)}}<sup>$</sup></div>
        <div class="stat-footer">
          <span>This week's expense</span>
          <span class="badge-down"></span>
        </div>
      </div>
    </div>

    <!-- Bottom Row -->
    <div class="bottom-row">
      <!-- Revenue Chart -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Revenue flow</h3>
          <div class="controls">
            <button class="active">Monthly</button>
            <button class="refresh">â†»</button>
          </div>
        </div>
        <div class="bar-chart">
          <div class="bar" style="height: 55%">
            <span class="bar-label">Apr</span>
            <span class="bar-value">2.5k</span>
          </div>
          <div class="bar" style="height: 70%">
            <span class="bar-label">May</span>
            <span class="bar-value"></span>
          </div>
          <div class="bar" style="height: 60%">
            <span class="bar-label">Jun</span>
            <span class="bar-value"></span>
          </div>
          <div class="bar" style="height: 65%">
            <span class="bar-label">Jul</span>
            <span class="bar-value"></span>
          </div>
          <div class="bar active" style="height: 85%">
            <span class="bar-label">Aug</span>
            <div class="bar-highlight">
              <div></div>
              <div class="perc"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Expense Split -->
      <div class="chart-card">
        <div class="chart-header">
          <h3>Expense split</h3>
          <select><option>Aug</option></select>
        </div>
        <div class="donut-container">
          <div class="donut-chart">
            <svg viewBox="0 0 200 200">
              <circle cx="100" cy="100" r="80" fill="none" stroke="#FFD93D" stroke-width="30" stroke-dasharray="125.66 502.65" transform="rotate(-90 100 100)"></circle>
              <circle cx="100" cy="100" r="80" fill="none" stroke="#60A5FA" stroke-width="30" stroke-dasharray="37.7 502.65" stroke-dashoffset="-125.66" transform="rotate(-90 100 100)"></circle>
              <circle cx="100" cy="100" r="80" fill="none" stroke="#F472B6" stroke-width="30" stroke-dasharray="37.7 502.65" stroke-dashoffset="-163.36" transform="rotate(-90 100 100)"></circle>
              <circle cx="100" cy="100" r="80" fill="none" stroke="#A78BFA" stroke-width="30" stroke-dasharray="62.83 502.65" stroke-dashoffset="-201.06" transform="rotate(-90 100 100)"></circle>
              <circle cx="100" cy="100" r="80" fill="none" stroke="#34D399" stroke-width="30" stroke-dasharray="75.4 502.65" stroke-dashoffset="-263.89" transform="rotate(-90 100 100)"></circle>
              <circle cx="100" cy="100" r="80" fill="none" stroke="#FBBF24" stroke-width="30" stroke-dasharray="163.96 502.65" stroke-dashoffset="-339.29" transform="rotate(-90 100 100)"></circle>
            </svg>
            <div class="donut-center">
              <div>Total</div>
              <div class="donut-value">{{formatNumber(dashboardData.monthlyExpense)}}<sup>$</sup></div>
            </div>
          </div>
          <div class="legend">
            <div class="legend-row">
              <div><span class="dot food"></span> Food <span></span></div>
              <div><span class="dot ent"></span> Entertainment <span></span></div>
            </div>
            <div class="legend-row">
              <div><span class="dot health"></span> Health <span></span></div>
              <div><span class="dot transport"></span> Transportation <span></span></div>
            </div>
            <div class="legend-row">
              <div><span class="dot bills"></span> Bills <span></span></div>
              <div><span class="dot misc"></span> Miscellaneous <span></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Budget Tracker Row -->
    <div class="budget-row">
      <div class="chart-card budget-card">
        <div class="chart-header">
          <h3>Budget Tracker</h3>
          <select><option>January</option></select>
        </div>
        <div class="budget-bars">
          <div *ngFor="let budget of dashboardData.budgets" class="budget-item">
            <div class="budget-info">
              <span class="budget-category">{{budget.category}}</span>
              <span class="budget-amount">${{formatNumber(budget.spent)}} / ${{formatNumber(budget.limit)}}</span>
            </div>
            <div class="budget-bar-container">
              <div class="budget-bar-bg">
                <div 
                  class="budget-bar-fill" 
                  [style.width.%]="budget.percentage"
                  [class.warning]="budget.percentage >= 80"
                  [class.good]="budget.percentage < 60">
                </div>
              </div>
              <span class="budget-percentage">{{budget.percentage}}%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
